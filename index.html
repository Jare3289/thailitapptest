<!-- --- SECTION: HEAD (replace existing <head>...</head>) --- -->
<head>
  <!-- meta ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- title ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) -->
  <title>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°: ‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏Ñ‡∏•‡∏á ‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢</title>

  <!-- ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö SEO / share -->
  <meta name="description" content="‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î: ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏•‡∏á ‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢">

  <!-- Favicon (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå icon ‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£) -->
  <link rel="icon" href="favicon.ico" />

  <!-- ---------- ‡∏ü‡πâ‡∏≠‡∏ô‡∏ï‡πå ---------- -->
  <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: Google Fonts (‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡πâ‡∏≠‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ) -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- ---------- CSS ‡∏´‡∏•‡∏±‡∏Å / utility ---------- -->
  <!-- Tailwind CDN (‡∏ñ‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ Tailwind ‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ) -->
  <!-- ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏Ñ‡∏∏‡∏ì build Tailwind ‡πÅ‡∏ö‡∏ö local ‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î CDN ‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà build ‡∏°‡∏≤ -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <!-- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå (local) ‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
  <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: <link rel="stylesheet" href="styles/main.css"> -->
  <link rel="stylesheet" href="styles.css">

  <!-- ---------- ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô (inline) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏≤‡∏™‡πÇ‡∏Ñ‡∏•‡∏á‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ---------- -->
  <!-- ‡∏ñ‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ CSS ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏™‡πà‡∏ß‡∏ô <style> ‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ -->
  <style>
    /* ‡∏Ñ‡∏•‡∏≤‡∏™‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏Ñ‡∏•‡∏á ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ */
    :root { font-family: "Noto Sans Thai", system-ui, sans-serif; }
    .kloang-container { white-space: pre-wrap; line-height: 1.6; }
    .bart { margin-bottom: 0.6rem; }
    .wak-na { font-weight: 600; display: inline-block; margin-right: 0.5rem; }
    .wak-lang { color: #444; display: inline-block; }
    .hardword { text-decoration: underline dotted; cursor: pointer; }
    /* ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‚Äî ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö styles.css ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì */
  </style>

  <!-- ---------- JavaScript libraries (‡πÇ‡∏´‡∏•‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å) ---------- -->
  <!-- ‡πÉ‡∏™‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á ‡πÜ -->
  <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ Firebase SDK ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà script ‡∏Ç‡∏≠‡∏á Firebase ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏™‡πà API key ‡πÅ‡∏ö‡∏ö‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞) -->
  <!-- <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-app.js"></script> -->

  <!-- ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÄ‡∏ä‡πà‡∏ô lodash, axios) ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> -->

  <!-- ---------- ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å (‡πÑ‡∏ü‡∏•‡πå JS ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå) ---------- -->
  <!-- ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ß‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡πâ‡∏≤‡∏¢ <body> ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡πá‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
  <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: <script src="app/main.js" defer></script> -->
  <script src="app/main.js" defer></script>

  <!-- ---------- ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏≠‡∏¢‡πà‡∏≤‡πÅ‡∏Å‡πâ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à) ---------- -->
  <!-- 1) ‡∏ñ‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì build ‡∏î‡πâ‡∏ß‡∏¢ bundler (webpack/rollup) ‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÑ‡∏ü‡∏•‡πå bundle ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ó‡∏ô CDN -->
  <!-- 2) ‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏±‡∏ö (API keys/credentials) ‡∏•‡∏á‡πÉ‡∏ô <head> ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢ -->
  <!-- 3) ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ Tailwind ‡πÅ‡∏ö‡∏ö local (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà CDN) ‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå CDN ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÑ‡∏ü‡∏•‡πå CSS ‡∏ó‡∏µ‡πà build ‡∏°‡∏≤‡πÅ‡∏ó‡∏ô -->

</head>
<!-- --- END SECTION: HEAD --- -->
<!-- --- SECTION: CSS / ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å (replace existing style block or styles.css content) --- -->
<style>
  /* ---------- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å ---------- */
  /* ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÑ‡∏ó‡∏¢ */
  :root {
    font-family: "Noto Sans Thai", "Sarabun", sans-serif;
    font-size: 16px;
    color: #222;
    background-color: #fff;
  }

  /* ---------- ‡πÇ‡∏Ñ‡∏£‡∏á‡∏£‡πà‡∏≤‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ ---------- */
  body {
    margin: 0;
    padding: 0;
    line-height: 1.6;
    background-color: #fafafa;
  }

  /* ---------- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÇ‡∏Ñ‡∏•‡∏á ---------- */
  .kloang-container {
    max-width: 700px;
    margin: 1.5rem auto;
    padding: 1.5rem;
    background: #ffffff;
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    white-space: pre-wrap;
  }

  /* ---------- ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏≤‡∏ó‡πÇ‡∏Ñ‡∏•‡∏á ---------- */
  .bart {
    display: flex;
    flex-direction: row;
    justify-content: start;
    align-items: baseline;
    margin-bottom: 0.5rem;
  }

  /* ---------- ‡∏Ñ‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏≤‡∏ó (wak-na) ---------- */
  .wak-na {
    font-weight: 600;
    color: #111;
    margin-right: 0.75rem;
    min-width: 160px;
  }

  /* ---------- ‡∏Ñ‡∏≥‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏≤‡∏ó (wak-lang) ---------- */
  .wak-lang {
    color: #444;
    font-weight: 400;
    flex: 1;
  }

  /* ---------- ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏¢‡∏≤‡∏Å (hardword) ---------- */
  .hardword {
    text-decoration: underline dotted #c56;
    cursor: pointer;
    transition: all 0.25s ease-in-out;
    color: #b91c1c;
    font-weight: 600;
  }

  /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡∏ö‡∏ô‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏¢‡∏≤‡∏Å */
  .hardword:hover {
    color: #dc2626;
    text-shadow: 0 0 3px rgba(220, 38, 38, 0.3);
  }

  /* ---------- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å ---------- */
  #hardword-info {
    margin-top: 1rem;
    padding: 1rem;
    background: #f9f9f9;
    border-radius: 0.75rem;
    font-size: 0.95rem;
    line-height: 1.5;
    display: none; /* ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å */
  }

  /* ---------- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å) ---------- */
  .hardword-image {
    display: block;
    width: 100%;
    max-width: 320px;
    margin: 0.75rem auto;
    border-radius: 0.5rem;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
  }

  /* ---------- ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ---------- */
  button {
    background: #2563eb;
    color: #fff;
    font-weight: 500;
    border: none;
    border-radius: 0.5rem;
    padding: 0.6rem 1.2rem;
    cursor: pointer;
    transition: background 0.3s;
  }

  button:hover {
    background: #1d4ed8;
  }

  /* ---------- Responsive (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠) ---------- */
  @media (max-width: 640px) {
    .kloang-container {
      margin: 1rem;
      padding: 1rem;
      font-size: 0.95rem;
    }
    .wak-na {
      min-width: 120px;
    }
  }
</style>
<!-- --- END SECTION: CSS --- -->
// --- SECTION: MISSION_DATA (replace existing mission/MISSION_01 object) ---
// ‡∏ß‡∏≤‡∏á‡∏ó‡∏±‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å mission ‡∏´‡∏£‡∏∑‡∏≠ MISSION_DATA.MISSION_01 ‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
const MISSION_DATA = {
  MISSION_01: {
    // ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à / metadata
    id: "MISSION_01",
    title: "‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏Ñ‡∏•‡∏á: ‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢",
    // ---------- POEM (HTML template) ----------
    // ‡πÇ‡∏Ñ‡∏•‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô HTML string ‚Äî ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô wak-lang ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô <span class="wak-lang">
    // ‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á 5 ‡∏ñ‡∏π‡∏Å‡∏´‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ <span class="hardword" data-word="...">...</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏î‡πâ
    poem: `<div class="kloang-container">
  <div class="bart">
    <span class="wak-na">‡πè ‡∏ö‡∏±‡∏á‡∏≠‡∏£‡∏≠‡∏±‡∏Ñ‡πÄ‡∏£‡∏®‡∏ú‡∏π‡πâ</span>
    <span class="wak-lang">‡∏û‡∏¥‡∏™‡∏°‡∏±‡∏¢ ‡∏ó‡πà‡∏≤‡∏ô‡∏ô‡∏≤</span>
  </div>

  <div class="bart">
    <span class="wak-na">‡∏ô‡∏≤‡∏°‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢</span>
    <span class="wak-lang">‡∏≠‡∏≠‡∏Å‡∏≠‡πâ‡∏≤‡∏á</span>
  </div>

  <div class="bart">
    <span class="wak-na">‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏∏‡∏ó‡∏ò‡∏û‡∏¥‡πÑ‡∏ä‡∏¢</span>
    <span class="wak-lang">‡πÄ‡∏ä‡πà‡∏ô‡∏≠‡∏∏‡∏õ ‡∏£‡∏≤‡∏ä‡πÅ‡∏Æ</span>
  </div>

  <div class="bart">
    <span class="wak-na">‡πÄ‡∏ñ‡∏•‡∏¥‡∏á‡∏Ñ‡∏ä‡∏≤‡∏ò‡∏≤‡∏£‡∏Ñ‡∏ß‡πâ‡∏≤‡∏á</span>
    <span class="wak-lang">
      ‡∏Ñ‡∏ß‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡∏ö‡∏ß‡∏ô
      <span class="hardword" data-word="‡πÑ‡∏Ñ‡∏•">‡πÑ‡∏Ñ‡∏•</span>
    </span>
  </div>

  <div style="height:0.6rem"></div>

  <div class="bart">
    <span class="wak-na">‡πè ‡∏û‡∏•‡πÑ‡∏Å‡∏£‡∏Å‡∏≠‡∏á‡∏ô‡πà‡∏≤‡πÄ‡∏£‡πâ‡∏≤</span>
    <span class="wak-lang">
      <span class="hardword" data-word="‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô">‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô</span>
      ‡∏Å‡∏±‡∏ô‡πÄ‡∏Æ‡∏¢
    </span>
  </div>

  <div class="bart">
    <span class="wak-na">‡∏ä‡πâ‡∏≤‡∏á‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏±‡∏ç</span>
    <span class="wak-lang">‡∏Ñ‡∏ä‡πÑ‡∏ó‡πâ</span>
  </div>

  <div class="bart">
    <span class="wak-na">‡∏™‡∏≤‡∏£‡∏ó‡∏£‡∏á‡∏ã‡∏ß‡∏î‡πÄ‡∏ã‡∏ú‡∏±‡∏ô</span>
    <span class="wak-lang">‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏•‡πà‡∏ô ‡πÄ‡∏ï‡∏•‡∏¥‡∏î‡πÅ‡∏Æ</span>
  </div>

  <div class="bart">
    <span class="wak-na">‡πÄ‡∏ï‡∏•‡∏á‡∏Ç‡∏±‡∏ö‡∏Ñ‡∏ä‡πÑ‡∏•‡πà‡πÉ‡∏Å‡∏•‡πâ</span>
    <span class="wak-lang">
      ‡∏´‡∏ß‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏ä‡∏≤‡∏ò‡∏≤‡∏£
      <span class="hardword" data-word="‡∏´‡∏ß‡∏¥‡∏î">‡∏´‡∏ß‡∏¥‡∏î</span>
    </span>
  </div>

  <div style="height:0.5rem"></div>

  <div class="bart">
    <span class="wak-na">
      (<span class="hardword" data-word="‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á">‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</span>,
      <span class="hardword" data-word="‡∏û‡∏•">‡∏û‡∏•</span>)
    </span>
  </div>

  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢/‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å -->
  <div id="hardword-info" aria-live="polite"></div>
</div>`,

    // ---------- hardWords (‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å 5 ‡∏Ñ‡∏≥) ----------
    // keys = ‡∏Ñ‡∏≥ (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö data-word ‡πÉ‡∏ô poem) ; value = object { meaning, points, imageURL }
    hardWords: {
      "‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á": {
        meaning: "‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö/‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏ò‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≠‡∏Å‡∏®‡∏∂‡∏Å",
        points: 15,
        imageURL: "https://img5.pic.in.th/file/secure-sv1/Gemini_Generated_Image_l358mtl358mtl358.png"
      },
      "‡πÑ‡∏Ñ‡∏•": {
        meaning: "‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ, ‡πÑ‡∏õ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ, ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà",
        points: 12,
        imageURL: "https://img2.pic.in.th/pic/Gemini_Generated_Image_got62vgot62vgot6.png"
      },
      "‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô": {
        meaning: "‡∏£‡∏ö‡∏û‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏∏‡πÄ‡∏î‡∏∑‡∏≠‡∏î, ‡∏õ‡∏∞‡∏ó‡∏∞‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏ô‡∏≤‡∏°‡∏£‡∏ö",
        points: 18,
        imageURL: "https://img2.pic.in.th/pic/Gemini_Generated_Image_m7s5sjm7s5sjm7s554828c3ed7e1f8ba.png"
      },
      "‡∏û‡∏•": {
        meaning: "‡∏ó‡∏´‡∏≤‡∏£, ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•, ‡∏ù‡πà‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£",
        points: 10,
        imageURL: "https://img2.pic.in.th/pic/Gemini_Generated_Image_sbsxfqsbsxfqsbsx.png"
      },
      "‡∏´‡∏ß‡∏¥‡∏î": {
        meaning: "‡πÄ‡∏â‡∏µ‡∏¢‡∏î, ‡∏à‡∏ß‡∏ô‡πÄ‡∏à‡∏µ‡∏¢‡∏ô, ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô",
        points: 14,
        imageURL: "https://img5.pic.in.th/file/secure-sv1/Gemini_Generated_Image_nofldgnofldgnofl409e8c1c02a80669.png"
      }
    },

    // ---------- ‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ (‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡∏¥‡∏î) ----------
    officialImageURL: "https://img5.pic.in.th/file/secure-sv1/Gemini_Generated_Image_s8u7sts8u7sts8u7.png",
    officialImageDescription: "‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤: ‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢‡∏ó‡∏£‡∏á‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏ö",

    // ---------- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á) ----------
    correctInterpretation: "‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢ ‡∏û‡∏£‡∏∞‡∏°‡πÄ‡∏´‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥ ‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∏‡∏î‡∏≠‡∏≠‡∏Å‡∏®‡∏∂‡∏Å‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏°‡∏´‡∏≤‡∏≠‡∏∏‡∏õ‡∏£‡∏≤‡∏ä‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏£‡∏á‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏£‡∏ö ‡∏Å‡∏≠‡∏á‡∏ó‡∏±‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡∏Å‡∏±‡∏ô ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ä‡πâ‡∏≤‡∏á‡∏ó‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£ ‡∏Å‡∏±‡∏ö‡∏ä‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥ ‡πÅ‡∏ï‡πà‡∏ä‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏µ ‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£‡∏Ç‡∏±‡∏ö‡∏ä‡πâ‡∏≤‡∏á‡πÑ‡∏•‡πà‡∏Ç‡∏ß‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏á‡∏û‡∏£‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥",

    // ---------- ‡∏Ñ‡∏≥‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô/‡∏ï‡∏£‡∏ß‡∏à (‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö match keyword) ----------
    correctInterpretationKeywords: [
      "‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢", "‡∏û‡∏£‡∏∞‡∏°‡πÄ‡∏´‡∏™‡∏µ", "‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡∏ó‡∏£‡∏á‡∏ä‡πâ‡∏≤‡∏á", "‡∏ä‡πâ‡∏≤‡∏á", "‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£",
      "‡∏Å‡∏≠‡∏á‡∏ó‡∏±‡∏û", "‡∏£‡∏ö", "‡πÑ‡∏•‡πà‡∏Ç‡∏ß‡∏¥‡∏î", "‡∏ó‡πâ‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏á", "‡∏û‡∏£‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á"
    ],

    // ---------- ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à (comprehension questions) ----------
    comprehensionQuestions: [
      {
        question: "‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢‡∏ó‡∏£‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏ï‡πà‡∏≠‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏™‡∏≤‡∏°‡∏µ",
        options: ["‡πÄ‡∏Å‡∏£‡∏á‡∏Å‡∏•‡∏±‡∏ß", "‡πÄ‡∏Å‡∏£‡∏á‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏´‡πà‡∏ß‡∏á‡πÉ‡∏¢", "‡πÇ‡∏Å‡∏£‡∏ò‡πÅ‡∏Ñ‡πâ‡∏ô", "‡πÄ‡∏â‡∏¢‡πÄ‡∏°‡∏¢"],
        correct: 1
      },
      {
        question: "‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏î‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢‡∏à‡∏∂‡∏á‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏Ç‡∏±‡∏ö‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏£‡∏ö",
        options: ["‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡πâ‡∏≤‡∏´‡∏≤‡∏ç", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏™‡∏≤‡∏°‡∏µ", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡∏Å‡∏±‡∏ö‡∏®‡∏±‡∏ï‡∏£‡∏π", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô"],
        correct: 1
      },
      {
        question: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡πÑ‡∏Ñ‡∏•' ‡πÉ‡∏ô‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡πÇ‡∏Ñ‡∏•‡∏á‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£",
        options: ["‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏õ", "‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ/‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ", "‡∏´‡∏ô‡∏µ", "‡∏¢‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏â‡∏¢‡πÜ"],
        correct: 1
      },
      {
        question: "‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î '‡πÄ‡∏ï‡∏•‡∏á‡∏Ç‡∏±‡∏ö‡∏Ñ‡∏ä‡πÑ‡∏•‡πà‡πÉ‡∏Å‡∏•‡πâ ‡∏´‡∏ß‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏ä‡∏≤‡∏ò‡∏≤‡∏£' ‡∏™‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£",
        options: ["‡∏ä‡πâ‡∏≤‡∏á‡πÑ‡∏•‡πà‡∏Ç‡∏ß‡∏¥‡∏î‡∏à‡∏ô‡∏ä‡∏ô‡∏∞", "‡∏ä‡πâ‡∏≤‡∏á‡πÑ‡∏•‡πà‡πÄ‡∏â‡∏µ‡∏¢‡∏î/‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏Ç‡∏ß‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏á‡∏û‡∏£‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á", "‡∏ä‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏á‡∏ó‡∏≤‡∏á", "‡∏ä‡πâ‡∏≤‡∏á‡∏ñ‡∏≠‡∏¢‡∏Å‡∏•‡∏±‡∏ö"],
        correct: 1
      }
    ]

  } // end MISSION_01
}; // end MISSION_DATA
// --- END SECTION: MISSION_DATA ---
// --- SECTION: POEM (replace existing poem: `...`) ---
// ‡∏ß‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤ poem (template string) ‡∏Ç‡∏≠‡∏á mission ‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
poem: `<div class="kloang-container" role="article" aria-label="‡πÇ‡∏Ñ‡∏•‡∏á‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢">
  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1 -->
  <div class="bart">
    <span class="wak-na">‡πè ‡∏ö‡∏±‡∏á‡∏≠‡∏£‡∏≠‡∏±‡∏Ñ‡πÄ‡∏£‡∏®‡∏ú‡∏π‡πâ</span>
    <!-- ‡∏û‡∏¥‡∏™‡∏°‡∏±‡∏¢ ‡∏ó‡πà‡∏≤‡∏ô‡∏ô‡∏≤ ‡πÄ‡∏õ‡πá‡∏ô wak-lang ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö -->
    <span class="wak-lang">‡∏û‡∏¥‡∏™‡∏°‡∏±‡∏¢ ‡∏ó‡πà‡∏≤‡∏ô‡∏ô‡∏≤</span>
  </div>

  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2 -->
  <div class="bart">
    <span class="wak-na">‡∏ô‡∏≤‡∏°‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢</span>
    <span class="wak-lang">‡∏≠‡∏≠‡∏Å‡∏≠‡πâ‡∏≤‡∏á</span>
  </div>

  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 3 -->
  <div class="bart">
    <span class="wak-na">‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏∏‡∏ó‡∏ò‡∏û‡∏¥‡πÑ‡∏ä‡∏¢</span>
    <span class="wak-lang">‡πÄ‡∏ä‡πà‡∏ô‡∏≠‡∏∏‡∏õ ‡∏£‡∏≤‡∏ä‡πÅ‡∏Æ</span>
  </div>

  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 4 (‡∏°‡∏µ‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å: ‡πÑ‡∏Ñ‡∏•) -->
  <div class="bart">
    <span class="wak-na">‡πÄ‡∏ñ‡∏•‡∏¥‡∏á‡∏Ñ‡∏ä‡∏≤‡∏ò‡∏≤‡∏£‡∏Ñ‡∏ß‡πâ‡∏≤‡∏á</span>
    <span class="wak-lang">
      ‡∏Ñ‡∏ß‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡∏ö‡∏ß‡∏ô
      <!-- data-word ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö key ‡πÉ‡∏ô hardWords -->
      <span class="hardword" data-word="‡πÑ‡∏Ñ‡∏•" aria-haspopup="true" aria-controls="hardword-info">‡πÑ‡∏Ñ‡∏•</span>
    </span>
  </div>

  <div style="height:0.6rem" aria-hidden="true"></div>

  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 5 (‡∏°‡∏µ‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å: ‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô) -->
  <div class="bart">
    <span class="wak-na">‡πè ‡∏û‡∏•‡πÑ‡∏Å‡∏£‡∏Å‡∏≠‡∏á‡∏ô‡πà‡∏≤‡πÄ‡∏£‡πâ‡∏≤</span>
    <span class="wak-lang">
      <span class="hardword" data-word="‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô" aria-haspopup="true" aria-controls="hardword-info">‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô</span>
      ‡∏Å‡∏±‡∏ô‡πÄ‡∏Æ‡∏¢
    </span>
  </div>

  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 6 -->
  <div class="bart">
    <span class="wak-na">‡∏ä‡πâ‡∏≤‡∏á‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏±‡∏ç</span>
    <span class="wak-lang">‡∏Ñ‡∏ä‡πÑ‡∏ó‡πâ</span>
  </div>

  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 7 -->
  <div class="bart">
    <span class="wak-na">‡∏™‡∏≤‡∏£‡∏ó‡∏£‡∏á‡∏ã‡∏ß‡∏î‡πÄ‡∏ã‡∏ú‡∏±‡∏ô</span>
    <span class="wak-lang">‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏•‡πà‡∏ô ‡πÄ‡∏ï‡∏•‡∏¥‡∏î‡πÅ‡∏Æ</span>
  </div>

  <!-- ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 8 (‡∏°‡∏µ‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å: ‡∏´‡∏ß‡∏¥‡∏î) -->
  <div class="bart">
    <span class="wak-na">‡πÄ‡∏ï‡∏•‡∏á‡∏Ç‡∏±‡∏ö‡∏Ñ‡∏ä‡πÑ‡∏•‡πà‡πÉ‡∏Å‡∏•‡πâ</span>
    <span class="wak-lang">
      ‡∏´‡∏ß‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏ä‡∏≤‡∏ò‡∏≤‡∏£
      <span class="hardword" data-word="‡∏´‡∏ß‡∏¥‡∏î" aria-haspopup="true" aria-controls="hardword-info">‡∏´‡∏ß‡∏¥‡∏î</span>
    </span>
  </div>

  <div style="height:0.5rem" aria-hidden="true"></div>

  <!-- ‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ (‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å: ‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á, ‡∏û‡∏•) -->
  <div class="bart">
    <span class="wak-na">
      (<span class="hardword" data-word="‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á" aria-haspopup="true" aria-controls="hardword-info">‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</span>,
      <span class="hardword" data-word="‡∏û‡∏•" aria-haspopup="true" aria-controls="hardword-info">‡∏û‡∏•</span>)
    </span>
  </div>

  <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢/‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å -->
  <!-- JS helper ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô display ‡πÄ‡∏õ‡πá‡∏ô block ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ -->
  <div id="hardword-info" class="hw-info" role="region" aria-live="polite"></div>
</div>`,
// --- SECTION: HARDWORDS (replace existing hardWords block) ---
// ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏¢‡∏≤‡∏Å 5 ‡∏Ñ‡∏≥ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö)
hardWords: {
  "‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á": {
    meaning: "‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏ò‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≠‡∏Å‡∏®‡∏∂‡∏Å",
    points: 15,
    imageURL: "https://img5.pic.in.th/file/secure-sv1/Gemini_Generated_Image_l358mtl358mtl358.png"
  },
  "‡πÑ‡∏Ñ‡∏•": {
    meaning: "‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ, ‡πÑ‡∏õ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ, ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà",
    points: 12,
    imageURL: "https://img2.pic.in.th/pic/Gemini_Generated_Image_got62vgot62vgot6.png"
  },
  "‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô": {
    meaning: "‡∏£‡∏ö‡∏û‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏∏‡πÄ‡∏î‡∏∑‡∏≠‡∏î, ‡∏õ‡∏∞‡∏ó‡∏∞‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏ô‡∏≤‡∏°‡∏£‡∏ö",
    points: 18,
    imageURL: "https://img2.pic.in.th/pic/Gemini_Generated_Image_m7s5sjm7s5sjm7s554828c3ed7e1f8ba.png"
  },
  "‡∏û‡∏•": {
    meaning: "‡∏ó‡∏´‡∏≤‡∏£, ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•, ‡∏ù‡πà‡∏≤‡∏¢‡∏ó‡∏´‡∏≤‡∏£",
    points: 10,
    imageURL: "https://img2.pic.in.th/pic/Gemini_Generated_Image_sbsxfqsbsxfqsbsx.png"
  },
  "‡∏´‡∏ß‡∏¥‡∏î": {
    meaning: "‡πÄ‡∏â‡∏µ‡∏¢‡∏î, ‡∏à‡∏ß‡∏ô‡πÄ‡∏à‡∏µ‡∏¢‡∏ô, ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô",
    points: 14,
    imageURL: "https://img5.pic.in.th/file/secure-sv1/Gemini_Generated_Image_nofldgnofldgnofl409e8c1c02a80669.png"
  }
},
// --- END SECTION: HARDWORDS ---
// --- SECTION: HELPERS (HARDWORD) ---
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å: ‡∏ú‡∏π‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å, ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢, ‡∏ô‡∏±‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ú‡∏¥‡∏î, ‡πÄ‡∏õ‡∏¥‡∏î‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏¥‡∏î >= 2
(function () {
  // ‡πÄ‡∏Å‡πá‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≥ (in-memory)
  const wrongCounts = {};

  // ‡∏õ‡∏£‡∏±‡∏ö UI ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á info ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô visible ‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
  function renderInfoHtml(word, hw, revealImage = false) {
    if (!hw) return `<div class="hw-unknown">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå: ${word}</div>`;
    const safeMeaning = escapeHtml(hw.meaning || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢");
    const img = hw.imageURL ? `<img src="${hw.imageURL}" alt="${escapeHtml(word)}" class="hardword-image">` : "";
    // ‡∏ñ‡πâ‡∏≤ revealImage = true ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô (‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏¥‡∏î 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
    const imgBlock = hw.imageURL
      ? (revealImage
          ? `<div style="text-align:center;margin-top:0.6rem">${img}</div>`
          : `<div style="float:left;margin-right:0.75rem;width:120px">${img}</div>`)
      : "";
    return `
      <div style="display:flex;gap:0.6rem;align-items:flex-start;max-width:720px;">
        ${imgBlock}
        <div style="flex:1">
          <div style="font-weight:700;margin-bottom:0.4rem">${escapeHtml(word)}</div>
          <div style="margin-bottom:0.6rem;white-space:normal">${safeMeaning}</div>
          <div style="text-align:right"><button type="button" id="hw-close-btn">‡∏õ‡∏¥‡∏î</button></div>
        </div>
      </div>
    `;
  }

  // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô XSS ‡πÄ‡∏ö‡∏≤ ‡πÜ ‡πÇ‡∏î‡∏¢‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏ó‡∏£‡∏Å‡πÉ‡∏ô innerHTML
  function escapeHtml(str = "") {
    return String(str)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏õ‡∏Å‡∏ï‡∏¥: meaning + ‡∏£‡∏π‡∏õ‡∏¢‡πà‡∏≠)
  function showHardwordInfo(word) {
    const infoBox = document.getElementById("hardword-info");
    if (!infoBox) return;
    const hw = (typeof hardWords !== "undefined" && hardWords && hardWords[word]) ? hardWords[word] : null;
    infoBox.innerHTML = renderInfoHtml(word, hw, false);
    infoBox.style.display = "block";
    // ‡∏ú‡∏π‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î
    const closeBtn = document.getElementById("hw-close-btn");
    if (closeBtn) {
      closeBtn.addEventListener("click", () => {
        infoBox.innerHTML = "";
        infoBox.style.display = "none";
      });
    }
    // ‡πÉ‡∏´‡πâ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠ accessibility
    infoBox.setAttribute("tabindex", "-1");
    infoBox.focus();
  }

  // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏¥‡∏î‡∏Ñ‡∏£‡∏ö threshold (2) ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏£‡∏π‡∏õ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô)
  function revealHardwordImage(word) {
    const infoBox = document.getElementById("hardword-info");
    if (!infoBox) return;
    const hw = (typeof hardWords !== "undefined" && hardWords && hardWords[word]) ? hardWords[word] : null;
    infoBox.innerHTML = renderInfoHtml(word, hw, true);
    infoBox.style.display = "block";
    const closeBtn = document.getElementById("hw-close-btn");
    if (closeBtn) closeBtn.addEventListener("click", () => { infoBox.innerHTML = ""; infoBox.style.display = "none"; });
    infoBox.setAttribute("tabindex", "-1");
    infoBox.focus();
  }

  // ‡πÄ‡∏û‡∏¥‡πà‡∏° count ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö 'word' ‡∏ú‡∏¥‡∏î
  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á quiz/game ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
  function incrementWrongCount(word) {
    if (!word) return;
    if (!wrongCounts[word]) wrongCounts[word] = 0;
    wrongCounts[word] += 1;
    // ‡∏ñ‡πâ‡∏≤‡∏ú‡∏¥‡∏î >= 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏£‡∏π‡∏õ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    if (wrongCounts[word] >= 2) {
      revealHardwordImage(word);
    }
  }

  // ‡∏ú‡∏π‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å <span class="hardword" data-word="...">
  function bindHardwordClicks() {
    document.querySelectorAll(".hardword").forEach(span => {
      const w = span.dataset.word || span.getAttribute("data-word");
      if (!w) return;
      // ‡πÉ‡∏´‡πâ pointer ‡πÅ‡∏•‡∏∞ aria attributes
      span.style.cursor = "pointer";
      span.setAttribute("role", "button");
      span.setAttribute("aria-pressed", "false");
      span.addEventListener("click", () => {
        showHardwordInfo(w);
      });
      // keyboard accessibility: Enter/Space triggers click
      span.addEventListener("keydown", (ev) => {
        if (ev.key === "Enter" || ev.key === " ") {
          ev.preventDefault();
          span.click();
        }
      });
    });
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢: ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ wrongCounts (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà)
  function resetWrongCounts() {
    for (const k in wrongCounts) { if (Object.prototype.hasOwnProperty.call(wrongCounts, k)) delete wrongCounts[k]; }
  }

  // ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ú‡∏π‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠ DOM ‡∏û‡∏£‡πâ‡∏≠‡∏°
  function init() {
    // safety: delay binding ‡∏ñ‡πâ‡∏≤ elements ‡∏ñ‡∏π‡∏Å render ‡πÅ‡∏ö‡∏ö dynamic
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", bindHardwordClicks);
    } else {
      bindHardwordClicks();
    }
  }

  // Expose API ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ (‡πÄ‡∏ä‡πà‡∏ô logic ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö)
  window.hwHelpers = {
    init,
    bindHardwordClicks,
    showHardwordInfo,
    revealHardwordImage,
    incrementWrongCount,
    resetWrongCounts,
    _debug_getWrongCounts: () => ({ ...wrongCounts })
  };

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å init ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î)
  init();
})();
 // --- END SECTION: HELPERS (HARDWORD) ---
// --- SECTION: MATCHING GAME (matching game logic) ---
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô renderMatchingGame(containerId, options)
// - containerId: id ‡∏Ç‡∏≠‡∏á element ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ß‡∏≤‡∏á‡πÄ‡∏Å‡∏° (string)
// - options: { shuffleSeed?, onFinish? } (optional)
// ‡πÉ‡∏ä‡πâ hardWords global ‡∏ó‡∏µ‡πà‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡πÉ‡∏ô SECTION: HARDWORDS
(function () {
  // ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏∏‡πà‡∏° (Fisher-Yates)
  function shuffleArray(arr) {
    const a = arr.slice();
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á element ‡∏Å‡∏≤‡∏£‡πå‡∏î (‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢
  function createCard(text, type, key) {
    // type: "word" | "meaning"
    const el = document.createElement("div");
    el.className = `mg-card mg-card-${type}`;
    el.tabIndex = 0;
    el.dataset.type = type;
    el.dataset.key = key; // key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ match
    el.innerText = text;
    // accessibility
    el.setAttribute("role", "button");
    el.setAttribute("aria-pressed", "false");
    return el;
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á layout ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
  function createGameShell(container) {
    container.innerHTML = "";
    const header = document.createElement("div");
    header.className = "mg-header";
    header.innerHTML = `<div class="mg-score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="mg-score">0</span></div>
                        <div class="mg-controls"><button id="mg-reset-btn">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button></div>`;
    const board = document.createElement("div");
    board.className = "mg-board";
    board.id = "mg-board";
    container.appendChild(header);
    container.appendChild(board);
    return board;
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠ render ‡πÄ‡∏Å‡∏°
  function renderMatchingGame(containerId, options = {}) {
    const container = document.getElementById(containerId);
    if (!container) {
      console.warn("renderMatchingGame: ‡πÑ‡∏°‡πà‡∏û‡∏ö container id=", containerId);
      return;
    }
    if (typeof hardWords === "undefined" || !hardWords) {
      container.innerHTML = "<div class='mg-error'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (hardWords) ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏°</div>";
      return;
    }

    // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏™‡∏£‡πâ‡∏≤‡∏á array ‡∏Ç‡∏≠‡∏á keys ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å hardWords
    const keys = Object.keys(hardWords);
    // ‡∏ñ‡πâ‡∏≤ keys ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 2 ‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏°
    if (keys.length < 2) {
      container.innerHTML = "<div class='mg-error'>‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà</div>";
      return;
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á shell
    const board = createGameShell(container);

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥ (word cards) ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ (meaning cards)
    const words = keys.map(k => ({ key: k, text: k }));
    const meanings = keys.map(k => ({ key: k, text: hardWords[k].meaning }));

    // ‡∏™‡∏∏‡πà‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö
    const shuffledWords = shuffleArray(words);
    const shuffledMeanings = shuffleArray(meanings);

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á DOM cards
    const wordColumn = document.createElement("div");
    wordColumn.className = "mg-column mg-column-words";
    const meaningColumn = document.createElement("div");
    meaningColumn.className = "mg-column mg-column-meanings";

    shuffledWords.forEach(item => {
      const card = createCard(item.text, "word", item.key);
      wordColumn.appendChild(card);
    });
    shuffledMeanings.forEach(item => {
      const card = createCard(item.text, "meaning", item.key);
      meaningColumn.appendChild(card);
    });

    // ‡∏ß‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏•‡∏á‡∏ö‡∏≠‡∏£‡πå‡∏î
    board.appendChild(wordColumn);
    board.appendChild(meaningColumn);

    // ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ CSS ‡πÄ‡∏â‡∏û‡∏≤‡∏∞) ‚Äî ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô styles.css ‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ
    if (!document.getElementById("mg-inline-styles")) {
      const style = document.createElement("style");
      style.id = "mg-inline-styles";
      style.innerHTML = `
        .mg-board { display:flex; gap:1rem; margin-top:1rem; }
        .mg-column { flex:1; display:flex; flex-direction:column; gap:0.5rem; }
        .mg-card { background:#fff; padding:0.6rem; border-radius:0.5rem; box-shadow:0 2px 6px rgba(0,0,0,0.06); cursor:pointer; user-select:none; }
        .mg-card:focus { outline:2px solid #60a5fa; }
        .mg-card.matched { background: #ecfccb; color:#065f46; font-weight:700; cursor:default; }
        .mg-card.disabled { opacity:0.5; pointer-events:none; }
        .mg-header { display:flex; justify-content:space-between; align-items:center; gap:1rem; }
        .mg-score { font-weight:700; }
        .mg-controls button { padding:0.4rem 0.8rem; border-radius:6px; border:none; background:#2563eb; color:#fff; cursor:pointer;}
      `;
      document.head.appendChild(style);
    }

    // Logic: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î (click-to-select pair matching)
    let firstSelection = null;
    let lockBoard = false;
    let score = 0;
    const scoreEl = container.querySelector("#mg-score");
    const resetBtn = container.querySelector("#mg-reset-btn");

    function setScore(n) {
      score = n;
      if (scoreEl) scoreEl.innerText = String(score);
    }

    function resetBoard() {
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï card classes ‡πÅ‡∏•‡∏∞ counters
      firstSelection = null;
      lockBoard = false;
      setScore(0);
      // ‡∏£‡∏µ-enable cards
      container.querySelectorAll(".mg-card").forEach(c => {
        c.classList.remove("matched", "disabled");
        c.setAttribute("aria-pressed", "false");
      });
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï wrongCounts ‡∏Ç‡∏≠‡∏á hwHelpers ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡πÑ‡∏°‡πà‡∏•‡∏ö‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏ú‡∏¢)
      if (window.hwHelpers && typeof window.hwHelpers.resetWrongCounts === "function") {
        window.hwHelpers.resetWrongCounts();
      }
    }

    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î: ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å hwHelpers.incrementWrongCount ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢/‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
    function handleWrongAttempt(key) {
      if (window.hwHelpers && typeof window.hwHelpers.incrementWrongCount === "function") {
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ hwHelpers ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏π‡∏õ (hwHelpers ‡∏à‡∏∞‡∏ô‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏π‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠ >=2)
        window.hwHelpers.incrementWrongCount(key);
      }
    }

    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å
    function handleMatch(cardA, cardB) {
      cardA.classList.add("matched", "disabled");
      cardB.classList.add("matched", "disabled");
      cardA.setAttribute("aria-pressed", "true");
      cardB.setAttribute("aria-pressed", "true");
      setScore(score + (hardWords[cardA.dataset.key] ? hardWords[cardA.dataset.key].points : 5));
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏°‡∏à‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á (‡∏ó‡∏∏‡∏Å key matched)
      const unmatched = container.querySelectorAll(".mg-card:not(.matched)");
      if (!unmatched || unmatched.length === 0) {
        // ‡∏à‡∏ö‡πÄ‡∏Å‡∏°
        if (options.onFinish && typeof options.onFinish === "function") {
          options.onFinish({ score });
        } else {
          // ‡πÅ‡∏™‡∏î‡∏á modal/alert ‡πÄ‡∏ö‡∏≤ ‡πÜ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ UI ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á)
          setTimeout(() => alert(`‡∏à‡∏ö‡πÄ‡∏Å‡∏°! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° ${score}`), 200);
        }
      }
    }

    // ‡∏ú‡∏π‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î
    container.querySelectorAll(".mg-card").forEach(card => {
      card.addEventListener("click", () => {
        if (lockBoard || card.classList.contains("matched") || card.classList.contains("disabled")) return;
        // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        if (!firstSelection) {
          firstSelection = card;
          card.classList.add("selected");
          card.setAttribute("aria-pressed", "true");
          return;
        }
        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
        if (firstSelection === card) {
          firstSelection.classList.remove("selected");
          firstSelection.setAttribute("aria-pressed", "false");
          firstSelection = null;
          return;
        }
        // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö key
        const keyA = firstSelection.dataset.key;
        const keyB = card.dataset.key;

        // ‡∏Å‡∏£‡∏ì‡∏µ match
        if (keyA === keyB && firstSelection.dataset.type !== card.dataset.type) {
          handleMatch(firstSelection, card);
          // clear selection
          firstSelection.classList.remove("selected");
          firstSelection = null;
        } else {
          // wrong attempt
          lockBoard = true;
          // ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å n ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡∏±‡∏ö wrongCounts ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
          // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å incrementWrongCount ‡∏î‡πâ‡∏ß‡∏¢ keyA ‡πÅ‡∏•‡∏∞ keyB (‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô
          handleWrongAttempt(keyA);
          handleWrongAttempt(keyB);
          // ‡πÅ‡∏™‡∏î‡∏á effect ‡∏ú‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï selection
          setTimeout(() => {
            firstSelection.classList.remove("selected");
            firstSelection.setAttribute("aria-pressed", "false");
            card.setAttribute("aria-pressed", "false");
            firstSelection = null;
            lockBoard = false;
          }, 700);
        }
      });
      // keyboard accessibility: Enter/Space ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô click
      card.addEventListener("keydown", (ev) => {
        if (ev.key === "Enter" || ev.key === " ") {
          ev.preventDefault();
          card.click();
        }
      });
    });

    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏õ‡∏∏‡πà‡∏°
    if (resetBtn) {
      resetBtn.addEventListener("click", () => {
        // ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢
        renderMatchingGame(containerId, options);
      });
    }

    // ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö (optional)
    // const hintBtn = document.createElement('button'); hintBtn.innerText='‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ'; hintBtn.onclick=()=>hwHelpers.revealHardwordImage(keys[0]); container.querySelector('.mg-controls').appendChild(hintBtn);

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï score ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà 0
    setScore(0);

    // bind hwHelpers clicks again (in case dynamic content)
    if (window.hwHelpers && typeof window.hwHelpers.bindHardwordClicks === "function") {
      window.hwHelpers.bindHardwordClicks();
    }

    // return API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏î‡πâ)
    return {
      reset: () => renderMatchingGame(containerId, options),
      getScore: () => score
    };
  }

  // export ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏π‡πà window
  window.renderMatchingGame = renderMatchingGame;

})();
 // --- END SECTION: MATCHING GAME ---
// --- SECTION: EVALUATE CREATIVE WRITING ---
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ó‡πÇ‡∏Ñ‡∏•‡∏á
// ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÉ‡∏´‡∏°‡πà + ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢
function evaluateCreativeWriting(text, type) {
  // --- 1. Core Data (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô) ---
  const R = "‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢ ‡∏û‡∏£‡∏∞‡∏°‡πÄ‡∏´‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥ ‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∏‡∏î‡∏≠‡∏≠‡∏Å‡∏®‡∏∂‡∏Å‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏°‡∏´‡∏≤‡∏≠‡∏∏‡∏õ‡∏£‡∏≤‡∏ä‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏£‡∏á‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏£‡∏ö ‡∏Å‡∏≠‡∏á‡∏ó‡∏±‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡∏Å‡∏±‡∏ô ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ä‡πâ‡∏≤‡∏á‡∏ó‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£ ‡∏Å‡∏±‡∏ö‡∏ä‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥ ‡πÅ‡∏ï‡πà‡∏ä‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏µ‡∏ä‡πâ‡∏≤‡∏á‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£ ‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£‡∏Ç‡∏±‡∏ö‡∏ä‡πâ‡∏≤‡∏á‡πÑ‡∏•‡πà‡∏Ç‡∏ß‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏á‡∏û‡∏£‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥";

  // ‡∏Ñ‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏´‡∏•‡∏±‡∏Å (L) ‚Äî ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡πá‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏£‡∏á/‡∏Ñ‡∏≥‡πÑ‡∏ß‡∏û‡∏à‡∏ô‡πå
  const L = {
    "‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à": ["‡∏û‡∏£‡∏∞", "‡∏≠‡∏á‡∏Ñ‡πå", "‡πÄ‡∏à‡πâ‡∏≤"],
    "‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢": ["‡∏ß‡∏µ‡∏£‡∏™‡∏ï‡∏£‡∏µ", "‡∏û‡∏£‡∏∞‡∏ö‡∏£‡∏°‡∏£‡∏≤‡∏ä‡πÄ‡∏ó‡∏ß‡∏µ", "‡∏û‡∏£‡∏∞‡∏°‡πÄ‡∏´‡∏™‡∏µ"],
    "‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á": ["‡πÅ‡∏ï‡πà‡∏á‡∏≠‡∏á‡∏Ñ‡πå", "‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢", "‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß", "‡∏™‡∏ß‡∏°‡∏ä‡∏∏‡∏î"],
    "‡∏°‡∏´‡∏≤‡∏≠‡∏∏‡∏õ‡∏£‡∏≤‡∏ä": ["‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡∏Ç‡∏∏‡∏ô‡∏ô‡∏≤‡∏á", "‡πÅ‡∏°‡πà‡∏ó‡∏±‡∏û"],
    "‡∏ó‡∏£‡∏á‡∏ä‡πâ‡∏≤‡∏á": ["‡∏Ç‡∏µ‡πà‡∏ä‡πâ‡∏≤‡∏á", "‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡∏ä‡πâ‡∏≤‡∏á"],
    "‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ": ["‡∏£‡∏ö", "‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏ô", "‡∏õ‡∏∞‡∏ó‡∏∞"],
    "‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£": ["‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏¥‡∏¢‡πå‡∏°‡∏≠‡∏ç", "‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å", "‡∏≠‡∏£‡∏¥"],
    "‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥": ["‡∏Å‡∏©‡∏±‡∏ï‡∏£‡∏¥‡∏¢‡πå‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤", "‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏±‡∏ß", "‡∏≠‡∏á‡∏Ñ‡πå‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏´‡∏±‡∏ß"],
    "‡∏Ç‡∏±‡∏ö": ["‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö", "‡πÄ‡∏£‡πà‡∏á", "‡∏Ñ‡∏ß‡∏ö"],
    "‡πÑ‡∏•‡πà‡∏Ç‡∏ß‡∏¥‡∏î": ["‡∏û‡∏∏‡πà‡∏á", "‡πÅ‡∏ó‡∏á", "‡∏ä‡∏ô"],
    "‡∏û‡∏£‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á": ["‡∏Ñ‡∏≠‡∏ä‡πâ‡∏≤‡∏á", "‡πÅ‡∏ó‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö"]
  };

  // ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (C) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
  const C = [
    { k: "‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏≠‡∏°‡πÅ‡∏õ‡∏•‡∏á (‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó)", cW: ["‡∏û‡∏£‡∏∞‡∏°‡πÄ‡∏´‡∏™‡∏µ", "‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡∏°‡∏´‡∏≤‡∏≠‡∏∏‡∏õ‡∏£‡∏≤‡∏ä", "‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢", "‡∏≠‡∏≠‡∏Å‡∏®‡∏∂‡∏Å"] },
    { k: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏£‡∏ö", cW: ["‡∏ó‡∏£‡∏á‡∏ä‡πâ‡∏≤‡∏á", "‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏£‡∏ö", "‡∏Å‡∏≠‡∏á‡∏ó‡∏±‡∏û‡∏´‡∏ô‡πâ‡∏≤"] },
    { k: "‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏´‡∏•‡∏±‡∏Å (‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢, ‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥, ‡πÅ‡∏õ‡∏£)", cW: ["‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏£‡∏¥‡πÇ‡∏¢‡∏ó‡∏±‡∏¢", "‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥", "‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡πÅ‡∏õ‡∏£"] },
    { k: "‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ/‡∏ä‡πâ‡∏≤‡∏á", cW: ["‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ", "‡∏ä‡πâ‡∏≤‡∏á‡∏ó‡∏£‡∏á", "‡∏£‡∏ö", "‡∏ä‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏°‡∏´‡∏≤‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥"] },
    { k: "‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏µ/‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢", cW: ["‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏µ", "‡πÑ‡∏•‡πà‡∏Ç‡∏ß‡∏¥‡∏î", "‡∏ó‡πâ‡∏≤‡∏¢‡∏ä‡πâ‡∏≤‡∏á", "‡∏û‡∏£‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á"] }
  ];

  // --- 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢ ---
  function lev(a, b) {  // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (fuzzy match)
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;
    if (a === b) return 0;
    const m = [];
    for (let i = 0; i < b.length + 1; i++) m[i] = [i];
    for (let j = 0; j < a.length + 1; j++) m[0][j] = j;
    for (let i = 1; i < b.length + 1; i++) {
      for (let j = 1; j < a.length + 1; j++) {
        const c = a[j - 1] === b[i - 1] ? 0 : 1;
        m[i][j] = Math.min(m[i - 1][j] + 1, m[i][j - 1] + 1, m[i - 1][j - 1] + c);
      }
    }
    return m[b.length][a.length];
  }

  function thr(w) { // ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡∏ú‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ñ‡∏≥
    if (w.length < 5) return 1;
    if (w.length < 9) return 2;
    return 3;
  }

  function tok(t) { // ‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå
    const ct = t.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g, "")
      .replace(/\s{2,}/g, " ")
      .toLowerCase()
      .trim();
    return ct.split(/\s+/).filter(tk => tk.length > 0);
  }

  // --- 3. ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏´‡∏•‡∏±‡∏Å ---
  const stI = text.trim();
  if (!stI) return { score: 0, feedback: "‚ö†Ô∏è ‡πÇ‡∏õ‡∏£‡∏î‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô" };

  const rtT = tok(R);
  const stT = tok(stI);
  const rtU = new Set(rtT);

  let wA = [];   // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≥
  let sS = 0;    // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
  let typoCount = 0;
  let cH = {};   // ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

  const sPC = 50 / C.length;  // 10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô
  let sF = "üìò ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ó‡∏≤‡∏á‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:\n";

  for (const sW of stT) {
    let s = "m5", f = "‡∏Ñ‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡πÑ‡∏ß‡∏û‡∏à‡∏ô‡πå";
    let iCSW = false, uCW = null;
    const t = thr(sW);

    for (const cW in L) {
      const sy = [cW].concat(L[cW]);
      for (const tW of sy) {
        const d = lev(sW, tW.toLowerCase());
        if (d === 0) {
          s = (sW === cW.toLowerCase()) ? "m1" : "m2";
          f = (s === "m1")
            ? `‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö: ${cW}`
            : `‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡πÑ‡∏ß‡∏û‡∏à‡∏ô‡πå‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°: ${cW}`;
          iCSW = true; uCW = cW; break;
        } else if (d <= t) {
          s = "m3"; f = `‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏´‡∏•‡∏±‡∏Å: ${tW} (‡∏™‡∏∞‡∏Å‡∏î‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á)`;
          typoCount++; iCSW = true; uCW = tW; break;
        }
      }
      if (iCSW) break;
    }

    if (!iCSW && rtU.has(sW)) s = "m4";

    if (iCSW) {
      C.forEach(c => {
        if (!cH[c.k]) {
          for (const cW of c.cW) {
            if (sW.includes(cW.toLowerCase())) {
              cH[c.k] = true; break;
            }
          }
        }
      });
    }
    wA.push({ w: sW, s: s, f: f });
  }

  // --- 4. ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ---
  const hC = Object.keys(cH).length;
  sS = Math.min(50, Math.round(hC * sPC));

  C.forEach(c => {
    sF += cH[c.k]
      ? `‚úì ${c.k}: ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°\n`
      : `‚úó ${c.k}: ‡∏Ç‡∏≤‡∏î‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç\n`;
  });

  // ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå (‡∏•‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ñ‡πâ‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ã‡πâ‡∏≥‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö)
  const uOS = new Set(wA.filter(w => w.s === "m4" || w.s === "m1").map(w => w.w));
  const sUS = new Set(stT).size;
  const oR = sUS > 0 ? uOS.size / sUS : 0;
  let pS = Math.round(50 * (1 - oR));
  pS = Math.max(0, Math.min(50, pS));

  const totalWords = stT.length;
  const typoThreshold = 0.1;
  const maxPenalty = 5;
  let typoPenalty = 0;
  let typoFeedback = "";

  if (totalWords > 5 && (typoCount / totalWords) > typoThreshold) {
    typoPenalty = Math.min(maxPenalty, Math.round(((typoCount / totalWords) - typoThreshold) * 50));
    typoFeedback = `‚ö†Ô∏è ‡∏û‡∏ö‡∏Ñ‡∏≥‡∏™‡∏∞‡∏Å‡∏î‡∏ú‡∏¥‡∏î ${typoCount} ‡∏Ñ‡∏≥ (‡∏´‡∏±‡∏Å ${typoPenalty} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)\n`;
  } else if (typoCount > 0) {
    typoFeedback = `‚òëÔ∏è ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏∞‡∏Å‡∏î‡∏ú‡∏¥‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ${typoCount} ‡∏Ñ‡∏≥ (‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)\n`;
  }

  // ‡∏£‡∏ß‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  const tS = sS + pS - typoPenalty;
  const oP = (oR * 100).toFixed(0);

  let qF = "\nüìó ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°:\n";
  if (oR > 0.6) qF += `‚úó ‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (${oP}%)\n`;
  else if (oR >= 0.3) qF += `‚ñ≥ ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (${oP}%)\n`;
  else qF += `‚úì ‡∏î‡∏µ‡∏°‡∏≤‡∏Å (${oP}%)\n`;

  let co = `\nüìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${tS} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô\n`;
  if (tS >= 80) co += "‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏©‡∏≤‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏î‡∏µ";
  else if (tS >= 60) co += "‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏î‡∏µ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ";
  else co += "‡∏Ñ‡∏ß‡∏£‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡πÑ‡∏ß‡∏û‡∏à‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏ö‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";

  return {
    totalScore: Math.max(0, tS),
    semanticScore: sS,
    paraphrasingScore: pS,
    wordAnalysis: wA,
    feedback: sF + typoFeedback + qF + co
  };
}
// --- END SECTION: EVALUATE CREATIVE WRITING ---
// --- SECTION: SHOW WRITING FEEDBACK (replace existing feedback renderer) ---
/**
 * ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°
 * - type: string (‡πÄ‡∏ä‡πà‡∏ô 'interpretation' ‡∏´‡∏£‡∏∑‡∏≠ 'imagination') ‚Äî ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏¢‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
 * - evaluation: object ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å evaluateCreativeWriting(...)
 * - opts: optional { containerId: 'writing-feedback', concise: false }
 */
function showWritingFeedback(type, evaluation, opts = {}) {
  const containerId = opts.containerId || 'writing-feedback';
  let container = document.getElementById(containerId);

  // ‡∏ñ‡πâ‡∏≤ container ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á element ‡πÅ‡∏•‡∏∞‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢ body
  if (!container) {
    container = document.createElement('section');
    container.id = containerId;
    container.setAttribute('aria-live', 'polite');
    container.style.maxWidth = '820px';
    container.style.margin = '1rem auto';
    container.style.padding = '1rem';
    container.style.borderRadius = '0.75rem';
    container.style.background = '#ffffff';
    container.style.boxShadow = '0 6px 18px rgba(0,0,0,0.06)';
    // ‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
    document.body.appendChild(container);
  }

  // ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢: ‡∏ñ‡πâ‡∏≤ evaluation ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏°‡∏≤
  if (!evaluation || typeof evaluation !== 'object') {
    container.innerHTML = `<div style="color:#b91c1c;font-weight:600">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>`;
    return;
  }

  // ‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å evaluation
  const totalScore = typeof evaluation.totalScore !== 'undefined' ? evaluation.totalScore : (evaluation.score || 0);
  const semanticScore = evaluation.semanticScore || 0;
  const paraphrasingScore = evaluation.paraphrasingScore || 0;
  const wordAnalysis = Array.isArray(evaluation.wordAnalysis) ? evaluation.wordAnalysis : [];
  const feedback = evaluation.feedback || '';

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏Ç‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
  // ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á innerHTML ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô feedback ‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö) ‚Äî ‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏™‡∏î‡∏á
  function safeHtml(str = '') {
    return String(str)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;")
      .replace(/\n/g, '<br>');
  }

  // ‡∏™‡∏µ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö
  function scoreColor(score) {
    if (score >= 80) return '#16a34a';      // ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
    if (score >= 60) return '#f59e0b';      // ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
    return '#ef4444';                       // ‡πÅ‡∏î‡∏á
  }

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô header (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° + ‡πÅ‡∏ñ‡∏ö)
  const headerHtml = `
    <div style="display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:1rem;">
      <div style="flex:1">
        <h3 style="margin:0 0 0.25rem 0;font-size:1.05rem">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô: ${safeHtml(type || '‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°')}</h3>
        <div style="font-size:0.95rem;color:#444">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: <strong style="font-size:1.25rem">${safeHtml(totalScore)}</strong></div>
        <div aria-hidden="true" style="height:0.5rem"></div>
        <div style="background:#eee;border-radius:999px;overflow:hidden;height:12px;">
          <div style="width:${Math.max(0, Math.min(100, totalScore))}%;height:12px;background:${scoreColor(totalScore)};transition:width 0.4s;"></div>
        </div>
      </div>

      <div style="min-width:220px;text-align:right">
        <div style="font-size:0.85rem;color:#666">‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏≤‡∏£‡∏∞: <strong>${safeHtml(semanticScore)}</strong></div>
        <div style="font-size:0.85rem;color:#666">‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°: <strong>${safeHtml(paraphrasingScore)}</strong></div>
      </div>
    </div>
  `;

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ wordAnalysis (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
  let wordAnalysisHtml = '';
  if (wordAnalysis.length > 0) {
    wordAnalysisHtml += `
      <div style="margin-top:0.9rem">
        <div style="font-weight:700;margin-bottom:0.4rem">‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥ (‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏≥‡∏ó‡∏µ‡∏•‡∏∞‡∏Ñ‡∏≥)</div>
        <table style="width:100%;border-collapse:collapse;font-size:0.95rem;">
          <thead>
            <tr style="text-align:left;color:#444">
              <th style="padding:0.4rem 0.6rem 0.4rem 0">‡∏Ñ‡∏≥</th>
              <th style="padding:0.4rem 0.6rem">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
              <th style="padding:0.4rem 0.6rem">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</th>
            </tr>
          </thead>
          <tbody>
    `;
    for (const wa of wordAnalysis) {
      const statusMap = {
        'm1': '‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏´‡∏•‡∏±‡∏Å',
        'm2': '‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡πÑ‡∏ß‡∏û‡∏à‡∏ô‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°',
        'm3': '‡∏™‡∏∞‡∏Å‡∏î‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á (‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö)',
        'm4': '‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö',
        'm5': '‡∏Ñ‡∏≥‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á/‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å'
      };
      const stLabel = statusMap[wa.s] || wa.s;
      wordAnalysisHtml += `
        <tr>
          <td style="padding:0.45rem 0.6rem;border-top:1px solid #f3f3f3">${safeHtml(wa.w)}</td>
          <td style="padding:0.45rem 0.6rem;border-top:1px solid #f3f3f3">${safeHtml(stLabel)}</td>
          <td style="padding:0.45rem 0.6rem;border-top:1px solid #f3f3f3;color:#555">${safeHtml(wa.f)}</td>
        </tr>
      `;
    }
    wordAnalysisHtml += `</tbody></table></div>`;
  }

  // ‡∏™‡πà‡∏ß‡∏ô feedback ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏¢‡∏≤‡∏ß) ‚Äî ‡∏°‡∏≤‡∏à‡∏≤‡∏Å evaluator (‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ö‡∏ö safe)
  const feedbackHtml = `
    <div style="margin-top:0.9rem">
      <div style="font-weight:700;margin-bottom:0.3rem">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞/‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</div>
      <div style="color:#333;font-size:0.95rem;line-height:1.5">${safeHtml(feedback)}</div>
    </div>
  `;

  // ‡∏õ‡∏∏‡πà‡∏°‡∏ä‡πà‡∏ß‡∏¢ (‡∏õ‡∏¥‡∏î / ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å feedback)
  const controlsHtml = `
    <div style="display:flex;gap:0.5rem;justify-content:flex-end;margin-top:0.8rem">
      <button id="${containerId}-copy-btn" style="background:#10b981">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
      <button id="${containerId}-close-btn" style="background:#ef4444">‡∏õ‡∏¥‡∏î</button>
    </div>
  `;

  // ‡∏£‡∏ß‡∏° HTML ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏•‡∏á container
  container.innerHTML = headerHtml + wordAnalysisHtml + feedbackHtml + controlsHtml;

  // ‡∏ú‡∏π‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°
  const closeBtn = document.getElementById(`${containerId}-close-btn`);
  if (closeBtn) {
    closeBtn.addEventListener('click', () => {
      container.style.display = 'none';
    });
  }

  const copyBtn = document.getElementById(`${containerId}-copy-btn`);
  if (copyBtn) {
    copyBtn.addEventListener('click', () => {
      const textToCopy = `${type || '‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°'} ‚Äî ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${totalScore}\n\n${feedback}\n`;
      try {
        navigator.clipboard.writeText(textToCopy);
        copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß';
        setTimeout(() => copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥', 1500);
      } catch (e) {
        // fallback: select and prompt
        const ta = document.createElement('textarea');
        ta.value = textToCopy;
        document.body.appendChild(ta);
        ta.select();
        try { document.execCommand('copy'); copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß'; }
        catch (err) { alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ'); }
        document.body.removeChild(ta);
        setTimeout(() => copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥', 1500);
      }
    });
  }

  // ‡∏ó‡∏≥‡πÉ‡∏´‡πâ container ‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ view ‡∏ñ‡πâ‡∏≤‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà
  container.style.display = 'block';
  container.scrollIntoView({ behavior: 'smooth', block: 'center' });
}
// --- END SECTION: SHOW WRITING FEEDBACK ---
// --- SECTION: STEP 3 HANDLERS (evaluation trigger + event binding) ---
//
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° input ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (evaluateCreativeWriting)
// ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢ showWritingFeedback()
// 
// ‚öôÔ∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ: evaluateCreativeWriting() ‡πÅ‡∏•‡∏∞ showWritingFeedback() (‡∏à‡∏≤‡∏Å Section 8‚Äì9)

function setupStep3Handlers() {
  const inputId = 'student-writing-input';     // id ‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
  const btnId = 'evaluate-btn';                // id ‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏° "‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö"
  const resultContainerId = 'writing-feedback'; // id ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

  // --- 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ element ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏° ---
  const inputEl = document.getElementById(inputId);
  const evalBtn = document.getElementById(btnId);

  if (!inputEl || !evalBtn) {
    console.warn('[setupStep3Handlers] ‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö input ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤');
    return;
  }

  // --- 2. ‡∏ú‡∏π‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå ‚Äú‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‚Äù ---
  evalBtn.addEventListener('click', () => {
    const studentText = inputEl.value.trim();
    if (!studentText) {
      alert('‚ö†Ô∏è ‡πÇ‡∏õ‡∏£‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô');
      return;
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
    const result = evaluateCreativeWriting(studentText, 'interpretation');
    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
    showWritingFeedback('interpretation', result, { containerId: resultContainerId });
  });

  // --- 3. ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏£‡∏¥‡∏°: ‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏£‡∏ö 10 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ---
  let autoTimeout = null;
  inputEl.addEventListener('input', () => {
    const val = inputEl.value.trim();
    if (val.length < 10) return; // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ñ‡πâ‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 10 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£

    // debounce 800ms (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏Å‡∏¥‡∏ô 0.8 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏Ñ‡πà‡∏≠‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô)
    clearTimeout(autoTimeout);
    autoTimeout = setTimeout(() => {
      const result = evaluateCreativeWriting(val, 'interpretation');
      showWritingFeedback('interpretation', result, { containerId: resultContainerId });
    }, 800);
  });

  console.log('[setupStep3Handlers] ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
}

// --- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à ---
document.addEventListener('DOMContentLoaded', setupStep3Handlers);
// --- END SECTION: STEP 3 HANDLERS ---
// --- SECTION: MODAL / NAV / UI COMPONENTS ---
// Modal UI helper: ‡∏™‡∏£‡πâ‡∏≤‡∏á modal overlay + content area ‡πÅ‡∏•‡∏∞ expose API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î
(function () {
  // ‡∏ñ‡πâ‡∏≤ modal ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≥
  if (document.getElementById('eval-modal-root')) return;

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á overlay + modal container
  const modalRoot = document.createElement('div');
  modalRoot.id = 'eval-modal-root';
  modalRoot.setAttribute('aria-hidden', 'true');
  modalRoot.innerHTML = `
    <div id="eval-modal-overlay" style="position:fixed;inset:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;z-index:9998;opacity:0;pointer-events:none;transition:opacity .18s;"></div>
    <div id="eval-modal" role="dialog" aria-modal="true" aria-labelledby="eval-modal-title" style="position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(.98);min-width:300px;max-width:900px;width:90%;background:#fff;border-radius:10px;padding:1rem 1rem 1.25rem;box-shadow:0 20px 50px rgba(2,6,23,0.4);z-index:9999;opacity:0;pointer-events:none;transition:opacity .18s, transform .18s;">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:1rem;">
        <h3 id="eval-modal-title" style="margin:0;font-size:1.05rem">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h3>
        <div style="display:flex;gap:0.5rem">
          <button id="eval-modal-copy" aria-label="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å" style="background:#10b981;color:#fff;border:none;padding:0.4rem 0.6rem;border-radius:6px;cursor:pointer">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
          <button id="eval-modal-close" aria-label="‡∏õ‡∏¥‡∏î" style="background:#ef4444;color:#fff;border:none;padding:0.4rem 0.6rem;border-radius:6px;cursor:pointer">‡∏õ‡∏¥‡∏î</button>
        </div>
      </div>
      <div id="eval-modal-body" style="margin-top:0.8rem;max-height:60vh;overflow:auto"></div>
    </div>
  `;
  document.body.appendChild(modalRoot);

  // ‡πÄ‡∏û‡∏¥‡πà‡∏° inline styles (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‚Äî ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡πÑ‡∏ü‡∏•‡πå CSS ‡πÑ‡∏î‡πâ
  if (!document.getElementById('eval-modal-styles')) {
    const s = document.createElement('style');
    s.id = 'eval-modal-styles';
    s.innerHTML = `
      #eval-modal-root.show #eval-modal-overlay { opacity:1; pointer-events:auto; }
      #eval-modal-root.show #eval-modal { opacity:1; pointer-events:auto; transform:translate(-50%,-50%) scale(1); }
      /* responsive */
      @media (max-width:520px) {
        #eval-modal { padding:0.8rem; width:96%; }
        #eval-modal-body { font-size:0.95rem; }
      }
      /* small helper for content */
      .eval-score-badge { display:inline-block;padding:0.25rem .6rem;border-radius:999px;font-weight:700;background:#eef2ff;color:#1e3a8a;margin-left:0.6rem; }
      .eval-section { margin-bottom:0.6rem; }
      .eval-word-row { display:flex;gap:0.6rem;padding:0.45rem 0;border-top:1px solid #f3f3f3;align-items:flex-start; }
      .eval-word-row:first-child { border-top:0; }
    `;
    document.head.appendChild(s);
  }

  // element refs
  const root = document.getElementById('eval-modal-root');
  const overlay = document.getElementById('eval-modal-overlay');
  const modal = document.getElementById('eval-modal');
  const body = document.getElementById('eval-modal-body');
  const closeBtn = document.getElementById('eval-modal-close');
  const copyBtn = document.getElementById('eval-modal-copy');

  // helper: clear content
  function clearModal() { body.innerHTML = ''; }

  // helper: render evaluation object into modal body (safe)
  function renderEvaluationToModal(evaluation, type = '‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°') {
    if (!evaluation) {
      body.innerHTML = `<div style="color:#b91c1c">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>`;
      return;
    }
    const total = (typeof evaluation.totalScore !== 'undefined') ? evaluation.totalScore : (evaluation.score || 0);
    const sem = evaluation.semanticScore || 0;
    const para = evaluation.paraphrasingScore || 0;
    const feedback = (evaluation.feedback || '').replace(/\n/g,'<br>');
    const wordAnalysis = Array.isArray(evaluation.wordAnalysis) ? evaluation.wordAnalysis : [];

    // header
    let html = `<div class="eval-section"><strong>${escapeHtml(type)}</strong>
      <span class="eval-score-badge">${escapeHtml(String(total))} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
      <div style="color:#444;margin-top:0.35rem;font-size:0.95rem">‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏≤‡∏£‡∏∞: ${escapeHtml(String(sem))} &nbsp;|&nbsp; ‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°: ${escapeHtml(String(para))}</div>
      </div>`;

    // feedback
    html += `<div class="eval-section"><div style="font-weight:700;margin-bottom:0.3rem">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</div><div style="color:#333;line-height:1.5">${feedback}</div></div>`;

    // wordAnalysis (compact list)
    if (wordAnalysis.length) {
      html += `<div class="eval-section"><div style="font-weight:700;margin-bottom:0.3rem">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à</div>`;
      html += `<div>`;
      for (const wa of wordAnalysis) {
        const stLabel = (wa.s === 'm1' && '‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏´‡∏•‡∏±‡∏Å') || (wa.s === 'm2' && '‡πÑ‡∏ß‡∏û‡∏à‡∏ô‡πå') || (wa.s === 'm3' && '‡∏™‡∏∞‡∏Å‡∏î‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á') || (wa.s === 'm4' && '‡∏ã‡πâ‡∏≥‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö') || '‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á';
        html += `<div class="eval-word-row"><div style="min-width:110px;font-weight:600">${escapeHtml(wa.w)}</div><div style="color:#444">${escapeHtml(stLabel)}</div><div style="color:#666;flex:1">${escapeHtml(wa.f)}</div></div>`;
      }
      html += `</div></div>`;
    }

    // attach
    body.innerHTML = html;
  }

  // small helper to escape html
  function escapeHtml(str='') {
    return String(str)
      .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
      .replace(/"/g,'&quot;').replace(/'/g,'&#039;');
  }

  // open modal
  function openModal() {
    root.classList.add('show');
    root.setAttribute('aria-hidden','false');
    // set focus into modal for a11y
    modal.setAttribute('tabindex','-1');
    modal.focus();
  }

  // close modal
  function closeModal() {
    root.classList.remove('show');
    root.setAttribute('aria-hidden','true');
    clearModal();
  }

  // click overlay closes
  overlay.addEventListener('click', closeModal);
  closeBtn.addEventListener('click', closeModal);

  // keyboard: Esc closes
  document.addEventListener('keydown', (ev) => {
    if (ev.key === 'Escape' && root.classList.contains('show')) {
      closeModal();
    }
  });

  // copy button: ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å feedback text (fallbacks included)
  copyBtn.addEventListener('click', () => {
    const text = body.innerText || body.textContent || '';
    if (!text) return;
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(text).then(() => {
        copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß';
        setTimeout(() => copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å', 1400);
      });
    } else {
      const ta = document.createElement('textarea'); ta.value = text; document.body.appendChild(ta); ta.select();
      try { document.execCommand('copy'); copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß'; setTimeout(() => copyBtn.innerText = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å', 1400); } catch(e){ alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥'); }
      document.body.removeChild(ta);
    }
  });

  // Public API: showFeedbackModal(evaluation, type, opts)
  // opts: { autoScrollToModal:Boolean (default true) }
  function showFeedbackModal(evaluation, type='‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°', opts = {}) {
    renderEvaluationToModal(evaluation, type);
    openModal();
    if (opts.autoScrollToModal !== false) modal.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }

  // expose to global
  window.showFeedbackModal = showFeedbackModal;
  window.closeFeedbackModal = closeModal;

  // USAGE NOTE (for developer):
  // - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ modal ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å showWritingFeedback(...) ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î:
  //     showFeedbackModal(evaluation, type);
  //   ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô showWritingFeedback (Section 9) ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÅ‡∏¢‡∏Å‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ:
  //     const res = evaluateCreativeWriting(text); showWritingFeedback('interpretation', res); showFeedbackModal(res, 'interpretation');
})();
 // --- END SECTION: MODAL / NAV / UI COMPONENTS ---
<!-- --- SECTION: FOOTER HELPERS / PERSISTENCE / DEBUG (replace or append near end of body) --- -->
<script>
/*
  Footer helpers:
  - persistence for hwHelpers wrongCounts (optional)
  - simple app-level API (appHelpers) for debug and test
  - responsive & accessibility small fixes
  Place this block near the end of the body (before </body>)
*/

(function(){
  // config: set to false ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡∏á localStorage
  const PERSIST_WRONGCOUNTS = true;
  const STORAGE_KEY = 'kw_hw_wrongCounts_v1';

  // helper: safe access to hwHelpers
  function getHwHelpers() {
    return window.hwHelpers || null;
  }

  // Load persisted wrongCounts -> ‡∏ñ‡πâ‡∏≤ hwHelpers ‡∏°‡∏µ‡πÄ‡∏°‡∏ò‡∏≠‡∏î reset/get ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤
  function loadWrongCounts() {
    if (!PERSIST_WRONGCOUNTS) return;
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return;
      const obj = JSON.parse(raw || '{}');
      // ‡∏ñ‡πâ‡∏≤ hwHelpers ‡∏°‡∏µ API internal ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ (‡πÄ‡∏£‡∏≤‡∏°‡∏µ _debug_getWrongCounts ‡πÅ‡∏•‡∏∞ resetWrongCounts)
      const hh = getHwHelpers();
      if (hh && typeof hh.resetWrongCounts === 'function' && typeof hh._debug_getWrongCounts === 'function') {
        // reset internal then increment per loaded counts
        hh.resetWrongCounts();
        Object.keys(obj).forEach(word => {
          const count = Number(obj[word] || 0);
          for (let i=0;i<count;i++) {
            // incrementWrongCount available? ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏û‡∏ó‡∏ä‡πå‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏Å revealHardwordImage ‡πÄ‡∏°‡∏∑‡πà‡∏≠ count>=2
            if (typeof hh.incrementWrongCount === 'function') hh.incrementWrongCount(word);
          }
        });
      }
    } catch (e) {
      console.warn('loadWrongCounts failed', e);
    }
  }

  // Save wrongCounts from hwHelpers._debug_getWrongCounts() into localStorage
  function saveWrongCounts() {
    if (!PERSIST_WRONGCOUNTS) return;
    try {
      const hh = getHwHelpers();
      if (!hh || typeof hh._debug_getWrongCounts !== 'function') return;
      const counts = hh._debug_getWrongCounts();
      localStorage.setItem(STORAGE_KEY, JSON.stringify(counts || {}));
    } catch (e) {
      console.warn('saveWrongCounts failed', e);
    }
  }

  // Periodic autosave (every 6s) to persist counts
  let autosaveInterval = null;
  function startAutoSave() {
    if (!PERSIST_WRONGCOUNTS) return;
    if (autosaveInterval) clearInterval(autosaveInterval);
    autosaveInterval = setInterval(saveWrongCounts, 6000);
  }
  function stopAutoSave() {
    if (autosaveInterval) { clearInterval(autosaveInterval); autosaveInterval = null; }
  }

  // APP HELPERS (exposed as window.appHelpers)
  const appHelpers = {
    // debug
    getWrongCounts() {
      const hh = getHwHelpers();
      if (hh && typeof hh._debug_getWrongCounts === 'function') return hh._debug_getWrongCounts();
      return {};
    },
    resetWrongCounts() {
      const hh = getHwHelpers();
      if (hh && typeof hh.resetWrongCounts === 'function') hh.resetWrongCounts();
      // clear persisted storage too
      try { localStorage.removeItem(STORAGE_KEY); } catch(e){}
    },
    revealAllHardwordImages() {
      const hh = getHwHelpers();
      if (!hh) return;
      Object.keys(window.hardWords || {}).forEach(k => {
        if (typeof hh.revealHardwordImage === 'function') hh.revealHardwordImage(k);
      });
    },
    saveNow() { saveWrongCounts(); },
    loadNow() { loadWrongCounts(); }
  };

  // expose
  window.appHelpers = appHelpers;

  // init: load persisted and start autosave
  if (PERSIST_WRONGCOUNTS) {
    try {
      // small delay to allow hwHelpers to init first
      setTimeout(() => {
        loadWrongCounts();
        startAutoSave();
      }, 250);
    } catch(e){}
  }

  // small UX: focus trap for modal (improve a11y slightly)
  // if modal exists, ensure tab doesn't escape modal when open (lightweight)
  document.addEventListener('keydown', function(ev){
    try {
      const root = document.getElementById('eval-modal-root');
      if (!root || !root.classList.contains('show')) return;
      if (ev.key === 'Tab') {
        const focusables = root.querySelectorAll('button, [href], input, textarea, select, [tabindex]:not([tabindex="-1"])');
        if (!focusables || focusables.length === 0) return;
        const focusArr = Array.prototype.slice.call(focusables);
        const current = document.activeElement;
        const idx = focusArr.indexOf(current);
        if (ev.shiftKey) {
          // shift+tab
          if (idx === 0) { ev.preventDefault(); focusArr[focusArr.length-1].focus(); }
        } else {
          if (idx === focusArr.length - 1) { ev.preventDefault(); focusArr[0].focus(); }
        }
      }
    } catch(e){}
  });

  // small responsive CSS additions: inject if not present
  if (!document.getElementById('footer-helper-styles')) {
    const s = document.createElement('style');
    s.id = 'footer-helper-styles';
    s.innerHTML = `
      /* Footer helper responsive tweaks */
      @media (max-width:420px) {
        .kloang-container { padding: 0.75rem; font-size: 0.95rem; }
        .wak-na { min-width: 90px; font-size:0.95rem; }
        .hardword { font-size:0.98rem; }
        #hardword-info { font-size:0.95rem; padding:0.6rem; }
      }
      /* small improvement for mg-board on narrow screens */
      @media (max-width:720px) {
        .mg-board { flex-direction:column; }
      }
    `;
    document.head.appendChild(s);
  }

  // safety: before unload save once
  window.addEventListener('beforeunload', saveWrongCounts);

  // debug log
  console.log('[appHelpers] initialized. window.appHelpers available. PERSIST_WRONGCOUNTS=', PERSIST_WRONGCOUNTS);
})();
</script>
<!-- --- END SECTION: FOOTER HELPERS --- -->
